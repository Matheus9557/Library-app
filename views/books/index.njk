{% extends "layout.njk" %}

{% set title = "Menu" %}

{% block style %}
<style>
  .book-actions {
    cursor: pointer;
  }
  .book-actions a:link {
    color: black;
  }
  .book-actions a:visited {
    color: black;
  }
  .book-actions a:hover {
    text-decoration: none;
  }
  .nav-item {
    text-align: right;
  }
</style>
{% endblock %}

{% block content %}
<h1 class="mt-5 text-center">
  {{ title }}
</h1>

<div class="text-right">
  <a href="/books/create" class="btn btn-secondary rounded-circle mr-4 font-weight-bold"
     title="Cadastrar livro">
    +
  </a>
</div>

<section class="card-deck my-3">
  {% for book in books %}
  <div class="card-book col-sm-6 col-lg-4 col-xl-3 mb-3" id="book-{{ book.id }}">
    <div class="card">
      <div class="card-header text-center font-weight-bold">
        <span class="book-title">
          {{ book.title }}
        </span>
        <span class="book-actions float-right">
          <a href="/books/delete/{{ book.id }}" title="Apagar livro">
            <i class="far fa-trash-alt"></i>
          </a>
          <a href="/books/edit/{{ book.id }}" title="Editar livro">
            <i class="fas fa-pencil-alt"></i>
          </a>
        </span>
      </div>
      <div class="card-body p-0">
        <img src="{{ book.image }}" alt="{{ book.title }}" class="w-100">
      </div>
      <div class="card-footer text-right">
        <span class="book-author float-left badge badge-secondary">{{ book.author }}</span>
        <span class="book-description">{{ book.description }}</span>
      </div>
    </div>
  </div>
  {% endfor %}
</section>
{% endblock %}

{% block script %}
<script type="module">
  function formatDescription() {
    const descriptions = document.querySelectorAll('.card-footer .book-description');
    descriptions.forEach((description) => {
      if (description.textContent.length > 100) {
        description.textContent = description.textContent.substr(0, 100) + '...';
      }
    });
  }

  formatDescription();
</script>
{% endblock %}
